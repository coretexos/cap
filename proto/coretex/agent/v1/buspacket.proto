syntax = "proto3";

package coretex.agent.v1;

option go_package = "github.com/coretexos/cap/v2/go/coretex/agent/v1";
option java_package = "ai.coretex.cap.agent.v1";
option java_multiple_files = true;
option csharp_namespace = "coretex.Agent.V1";
option php_namespace = "coretex\\Agent\\V1";
option ruby_package = "coretex::Agent::V1";

import "google/protobuf/timestamp.proto";
import "coretex/agent/v1/job.proto";
import "coretex/agent/v1/heartbeat.proto";
import "coretex/agent/v1/alert.proto";

// BusPacket is the envelope for all traffic on the bus.
message BusPacket {
    string trace_id = 1;                    // correlates related packets
    string sender_id = 2;                   // emitting agent id
    google.protobuf.Timestamp created_at = 3; // emission time
    int32 protocol_version = 4;             // CAP wire version

    oneof payload {
        JobRequest job_request = 10;
        JobResult job_result = 11;
        Heartbeat heartbeat = 12;
        SystemAlert alert = 13;
    }
    bytes signature = 14;                   // digital signature of the serialized BusPacket
}
